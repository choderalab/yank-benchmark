options:
  minimize: yes
  verbose: yes
  output_dir: repex-rmsd-2
  temperature: 300*kelvin
  pressure: 1*atmosphere
  switch_experiment_interval: 20
  resume_setup: yes
  resume_simulation: yes
  processes_per_experiment: 1
  hydrogen_mass: 3.0 * amu
  checkpoint_interval: 10
  alchemical_pme_treatment: exact 

molecules:
  BRD4:
    filepath: input/BET_prot.pdb
    strip_protons: yes 
  ligands:
    filepath: input/all-ligands.mol2
    select: all
    openeye:
      quacpac: am1-bcc
    antechamber:
      charge_method: null

mcmc_moves:
    langevin:
        type: LangevinSplittingDynamicsMove
        timestep: 4.0*femtosecond
        splitting: 'V R O R V'
        reassign_velocities: yes
        n_steps: 500
        n_restart_attempts: 4

samplers:
    repex:
        type: ReplicaExchangeSampler
        mcmc_moves: langevin
        number_of_iterations: 2000

solvents:
  pme:
    nonbonded_method: PME
    switch_distance: 9*angstroms
    nonbonded_cutoff: 10*angstroms
    ewald_error_tolerance: 1.0e-4
    clearance: 9*angstroms
    positive_ion: Na+
    negative_ion: Cl-
    solvent_model: tip3p

systems:
  BRD4-complex:
    receptor: BRD4
    ligand: ligands
    solvent: pme
    leap:
      parameters: [leaprc.protein.ff14SB, leaprc.gaff2, leaprc.water.tip3p]


protocols:
  auto-protocol:
    complex:
      alchemical_path: auto
    solvent:
      alchemical_path: auto

  optimized-protocol:
    complex:
      alchemical_path:
        lambda_restraints: [0.0, 0.012443684131988916, 0.02711047621684396, 0.05167636244463669, 0.08272020033503069, 0.12071937222685389, 0.16026493588842397, 0.210264935888424, 0.260264935888424, 0.3434110495320693, 0.4203627149882124, 0.5190988413967247, 0.661760151161323, 0.8835306911318889, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
        lambda_electrostatics: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9784215294818531, 0.9564503693863198, 0.9318737428832105, 0.9087107624038343, 0.8852083753532997, 0.8646537129464978, 0.8416489962841461, 0.8170256552388856, 0.7920571986901938, 0.7658077355480074, 0.7449570233084576, 0.7198496741797776, 0.6958439111471267, 0.6753411751388382, 0.6515764433505278, 0.6287068587340873, 0.6055183883304284, 0.581071048109635, 0.5545503859322376, 0.5315019398376986, 0.5089706999647072, 0.4856951290792284, 0.4614135991228875, 0.4355296153694666, 0.4117895803910436, 0.38469647158699305, 0.3620244417437435, 0.3393816069289686, 0.31522037624245575, 0.29023779697639285, 0.2672833775918, 0.24170076207129618, 0.21426776782045387, 0.1898741295495571, 0.16684492522842773, 0.13931645396237421, 0.11426239910541998, 0.08658845118891648, 0.05812091203370049, 0.028630442312470153, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
        lambda_sterics: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9626306826917977, 0.9312504516242578, 0.9010128879853647, 0.8681639218444918, 0.8400163622043083, 0.8089429005446978, 0.7749278859496568, 0.7450143455264184, 0.7200600270254763, 0.6892543363488727, 0.6586736007060255, 0.6327314986934826, 0.6094160461041949, 0.5838756593751808, 0.5580724066691765, 0.5390100699651026, 0.5187039611945152, 0.49303358371666206, 0.46744738425177584, 0.44433098449606534, 0.4182100176071892, 0.39722515560934313, 0.3777654163462612, 0.3557011485172846, 0.33458915624669555, 0.3109744540095448, 0.2920837691678006, 0.2702275271868421, 0.2515232976449585, 0.23964670805270208, 0.2182558787258447, 0.1974110019897894, 0.18158839330541188, 0.16623152478998432, 0.149292853053838, 0.12789845418083406, 0.10681109897130887, 0.08409360613088195, 0.06015216534126602, 0.022664313128840215, 0.0]

experiments:
  sampler: repex
  system: BRD4-complex
  protocol: optimized-protocol
  restraint:
    type: PeriodicTorsionBoresch
