options:
  minimize: yes
  verbose: no
  output_dir: sams-twostage-boresch-dense
  temperature: 300*kelvin
  pressure: 1*atmosphere
  switch_experiment_interval: 50
  resume_setup: yes
  resume_simulation: yes
  processes_per_experiment: 1
  hydrogen_mass: 3.0 * amu
  checkpoint_interval: 50

  #annihilate_electrostatics: yes
  #annihilate_sterics: no
  #alchemical_pme_treatment: exact 

molecules:
  BRD4:
    filepath: input/BET_prot.pdb
    strip_protons: yes 
  ligands:
    filepath: input/all-ligands.mol2
    select: all
    openeye:
      quacpac: am1-bcc
    antechamber:
      charge_method: null

mcmc_moves:
    langevin:
        type: LangevinSplittingDynamicsMove
        timestep: 4.0*femtosecond
        splitting: 'V R R R O R R R V'
        n_steps: 1250

samplers:
    sams:
        type: SAMSSampler
        mcmc_moves: langevin
        state_update_scheme: global-jump
        flatness_threshold: 10.0
        number_of_iterations: 200000
        gamma0: 10.0
        online_analysis_interval: null

solvents:
  pme:
    nonbonded_method: PME
    switch_distance: 9*angstroms
    nonbonded_cutoff: 10*angstroms
    ewald_error_tolerance: 1.0e-4
    clearance: 9*angstroms
    positive_ion: Na+
    negative_ion: Cl-
    solvent_model: tip3p

systems:
  BRD4-complex:
    receptor: BRD4
    ligand: ligands
    solvent: pme
    leap:
      parameters: [leaprc.protein.ff14SB, leaprc.gaff2, leaprc.water.tip3p]

protocols:
  auto-protocol:
    complex:
      alchemical_path: auto
    solvent:
      alchemical_path: auto

  dense-protocol:
    complex:
      alchemical_path:
        lambda_restraints:     [ 0.000,  0.050,  0.100,  0.150,  0.200,  0.250,  0.300,  0.350,  0.400,  0.450,  0.500,  0.550,  0.600,  0.650,  0.700,  0.750,  0.800,  0.850,  0.900,  0.950,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000]
        lambda_electrostatics: [ 1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  0.990,  0.980,  0.970,  0.960,  0.949,  0.939,  0.929,  0.919,  0.909,  0.899,  0.889,  0.879,  0.869,  0.859,  0.848,  0.838,  0.828,  0.818,  0.808,  0.798,  0.788,  0.778,  0.768,  0.758,  0.747,  0.737,  0.727,  0.717,  0.707,  0.697,  0.687,  0.677,  0.667,  0.657,  0.646,  0.636,  0.626,  0.616,  0.606,  0.596,  0.586,  0.576,  0.566,  0.556,  0.545,  0.535,  0.525,  0.515,  0.505,  0.495,  0.485,  0.475,  0.465,  0.455,  0.444,  0.434,  0.424,  0.414,  0.404,  0.394,  0.384,  0.374,  0.364,  0.354,  0.343,  0.333,  0.323,  0.313,  0.303,  0.293,  0.283,  0.273,  0.263,  0.253,  0.242,  0.232,  0.222,  0.212,  0.202,  0.192,  0.182,  0.172,  0.162,  0.152,  0.141,  0.131,  0.121,  0.111,  0.101,  0.091,  0.081,  0.071,  0.061,  0.051,  0.040,  0.030,  0.020,  0.010,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000]
        lambda_sterics:        [ 1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  0.990,  0.980,  0.970,  0.960,  0.949,  0.939,  0.929,  0.919,  0.909,  0.899,  0.889,  0.879,  0.869,  0.859,  0.848,  0.838,  0.828,  0.818,  0.808,  0.798,  0.788,  0.778,  0.768,  0.758,  0.747,  0.737,  0.727,  0.717,  0.707,  0.697,  0.687,  0.677,  0.667,  0.657,  0.646,  0.636,  0.626,  0.616,  0.606,  0.596,  0.586,  0.576,  0.566,  0.556,  0.545,  0.535,  0.525,  0.515,  0.505,  0.495,  0.485,  0.475,  0.465,  0.455,  0.444,  0.434,  0.424,  0.414,  0.404,  0.394,  0.384,  0.374,  0.364,  0.354,  0.343,  0.333,  0.323,  0.313,  0.303,  0.293,  0.283,  0.273,  0.263,  0.253,  0.242,  0.232,  0.222,  0.212,  0.202,  0.192,  0.182,  0.172,  0.162,  0.152,  0.141,  0.131,  0.121,  0.111,  0.101,  0.091,  0.081,  0.071,  0.061,  0.051,  0.040,  0.030,  0.020,  0.010,  0.000]
    solvent:
      alchemical_path:
        lambda_electrostatics: [ 1.000,  0.990,  0.980,  0.970,  0.960,  0.949,  0.939,  0.929,  0.919,  0.909,  0.899,  0.889,  0.879,  0.869,  0.859,  0.848,  0.838,  0.828,  0.818,  0.808,  0.798,  0.788,  0.778,  0.768,  0.758,  0.747,  0.737,  0.727,  0.717,  0.707,  0.697,  0.687,  0.677,  0.667,  0.657,  0.646,  0.636,  0.626,  0.616,  0.606,  0.596,  0.586,  0.576,  0.566,  0.556,  0.545,  0.535,  0.525,  0.515,  0.505,  0.495,  0.485,  0.475,  0.465,  0.455,  0.444,  0.434,  0.424,  0.414,  0.404,  0.394,  0.384,  0.374,  0.364,  0.354,  0.343,  0.333,  0.323,  0.313,  0.303,  0.293,  0.283,  0.273,  0.263,  0.253,  0.242,  0.232,  0.222,  0.212,  0.202,  0.192,  0.182,  0.172,  0.162,  0.152,  0.141,  0.131,  0.121,  0.111,  0.101,  0.091,  0.081,  0.071,  0.061,  0.051,  0.040,  0.030,  0.020,  0.010,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000]
        lambda_sterics:        [ 1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  1.000,  0.990,  0.980,  0.970,  0.960,  0.949,  0.939,  0.929,  0.919,  0.909,  0.899,  0.889,  0.879,  0.869,  0.859,  0.848,  0.838,  0.828,  0.818,  0.808,  0.798,  0.788,  0.778,  0.768,  0.758,  0.747,  0.737,  0.727,  0.717,  0.707,  0.697,  0.687,  0.677,  0.667,  0.657,  0.646,  0.636,  0.626,  0.616,  0.606,  0.596,  0.586,  0.576,  0.566,  0.556,  0.545,  0.535,  0.525,  0.515,  0.505,  0.495,  0.485,  0.475,  0.465,  0.455,  0.444,  0.434,  0.424,  0.414,  0.404,  0.394,  0.384,  0.374,  0.364,  0.354,  0.343,  0.333,  0.323,  0.313,  0.303,  0.293,  0.283,  0.273,  0.263,  0.253,  0.242,  0.232,  0.222,  0.212,  0.202,  0.192,  0.182,  0.172,  0.162,  0.152,  0.141,  0.131,  0.121,  0.111,  0.101,  0.091,  0.081,  0.071,  0.061,  0.051,  0.040,  0.030,  0.020,  0.010,  0.000]

experiments:
  sampler: sams
  system: BRD4-complex
  protocol: dense-protocol
  restraint:
    type: PeriodicTorsionBoresch
